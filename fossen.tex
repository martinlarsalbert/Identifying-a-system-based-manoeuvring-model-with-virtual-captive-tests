\noindent A ship’s kinematics are expressed amidship in a ship fixed coordinate system, rotated around the Earth-fixed coordinate system $x_0$ by the heading angle $\Psi$ as in \autoref{fig:reference_frames}. 
\begin{figure}[h!]
    \centering
    \includegraphics[width=6cm, height=6cm]{figures/reference_frames.png}
    \caption{Ship velocities and forces in the Earth-fixed and ship-fixed coordinate systems.}
    \label{fig:reference_frames}
\end{figure}

Forces and motions are expressed in three degrees of freedom, i.e., surge $X$, sway $Y$, and yaw $N$. During a ship's maneuvering, since the forces do not depend on the position ($x_0,y_0$) or heading $\Psi$, ship kinematics and motion equations can be expressed as a function of the velocity vector $\pmb{\bm{\upsilon}}$ as,
% \begin{equation}
%     \label{eq:upsilon}
%     %\input{equations/155.10_Fossen_model.upsilon}
%     \pmb{\bm{\upsilon}} = \left[\begin{matrix}u\\v\\r\end{matrix}\right]
% \end{equation}
% The equation of motion can thus be expressed as \autoref{eq:eom}
\begin{equation}
    \label{eq:eom}
    \mathbf{F} = \mathbf{M}  \pmb{\bm{\dot{\upsilon}}}, \hspace{1cm}
    \pmb{\bm{\upsilon}} = \left[\begin{matrix}u\\v\\r\end{matrix}\right]
\end{equation}
where $\pmb{\bm{\dot{\upsilon}}}$ is the acceleration vector, $\mathbf{M}$ is the system inertia matrix and $\mathbf{F}$ is the total force vector.
% The velocity transition can thus be expressed as
% \begin{equation}
%     \label{eq:acc}
%     \pmb{\bm{\dot{\upsilon}}} = \mathbf{M}^{-1}\mathbf{F}
% \end{equation}
The total forces can be divided into the Coriolis–centripetal matrix $\mathbf{C}$ and the damping force vector $\mathbf{D}$ \citep{fossenHandbookMarineCraft2011}, while the control forces from the rudder and propeller are included in the $\mathbf{D}$ matrix as follows,
\begin{equation}
    \label{eq:C_expanded}
    \input{equations/155.10_Fossen_model.C_expanded}, \hspace{0.3cm}
    \input{equations/155.10_Fossen_model.D}
\end{equation}
% \begin{equation}
%     \label{eq:D}
%     \input{equations/155.10_Fossen_model.D}
% \end{equation}
where $X_{\dot{u}},Y_{\dot{v}},Y_{\dot{r}},N_{\dot{v}},N_{\dot{r}} < 0$, then the total force vector $\mathbf{F}$ can now be expressed as:
\begin{equation}
    \label{eq:F_expanded}
    %\input{equations/155.10_Fossen_model.F_expanded}
\mathbf{F} = - \mathbf{C} \upsilon + \mathbf{D} =
\left[\begin{matrix}
X \\
Y \\
N \\
\end{matrix}\right]
=
\left[\begin{matrix}X_{D} - Y_{\dot{r}} r^{2} + m r^{2} x_{G} + r v \left(- Y_{\dot{v}} + m\right)\\Y_{D} + r u \left(X_{\dot{u}} - m\right)\\N_{D} + r u \left(Y_{\dot{r}} - m x_{G}\right) + \underbrace{u v \left(- X_{\dot{u}} + Y_{\dot{v}}\right)}_{\text{Munk moment}} \end{matrix}\right]
\end{equation}
where $u v \left(- X_{\dot{u}} + Y_{\dot{v}}\right)$ in the yawing moment $N$ is the so called Munk moment \citep{fossenHandbookMarineCraft2011}; $r u \left(X_{\dot{u}} - m\right)$ in the sway force $Y$ has the apparent centrifugal force from added mass and rigid body mass with $X_{\dot{u}}<0$, so that both added mass and rigid body mass create the centrifugal force acting outward in the turn. Both the added mass and rigid body mass will thus act to starboard on a port turn.
% \begin{equation}
%     \label{eq:upsilon1d}
% \mathbf{F} = - \mathbf{C} \upsilon + \mathbf{D}
% \end{equation}

For the calculation of acceleration $\pmb{\bm{\dot{\upsilon}}}$ in \autoref{fig:reference_frames}, the mass matrix $\mathbf{M}$ and its inverse can be calculated according to \citet{fossenHandbookMarineCraft2011} as shown in, 
\begin{equation}
    \label{eq:M_expanded}
    \input{equations/155.10_Fossen_model.M_expanded},
   % \input{equations/155.10_Fossen_model.M_inv}
\end{equation}
% \begin{equation}
%     \label{eq:M_inv}
%     \input{equations/155.10_Fossen_model.M_inv}
% \end{equation}
where $X_{\hat{u}}$, $Y_{\hat{v}}, N_{\hat{r}}$, $Y_{\hat{r}}, N_{\hat{v}}$ represent added mass for surge, added mass for sway, added mass of inertia for yaw, added mass of inertia for sway-yaw coupling, and yaw-sway coupling, respectively. 

% the helper variable $\input{equations/155.10_Fossen_model.S}$.
% \begin{equation}
%     \label{eq:S}
%     \input{equations/155.10_Fossen_model.S}
% \end{equation}
\vspace{0.5cm}

